# Структура нового фронтенда и основные маршруты

Этот документ описывает текущее состояние фронтенда и API, чтобы было проще перейти от Jinja-шаблонов к полноценному React-приложению. Все примеры и пояснения приведены на русском языке, чтобы упростить дальнейшую работу.

## 1. Что уже реализовано в бэкенде

Фреймворк FastAPI предоставляет нам ряд REST-эндпоинтов, которыми будет пользоваться фронтенд:

- `POST /auth/login` — аутентификация пользователя. Принимает email и пароль, возвращает токен доступа.
- `POST /auth/register` — регистрация пользователя. Создаёт новую учётную запись, если email ещё не занят.
- `GET /auth/me` — получение информации о текущем пользователе по токену.
- `POST /auth/change-password` — смена пароля.
- `GET /auth/permissions` — чтение списка прав пользователя.

До перехода на React HTML-страницы логина и регистрации рендерились сервером в файле [`src/warehouse_service/routes/web.py`](../src/warehouse_service/routes/web.py). Нам важно сохранить эти URL (`/` и `/register`), чтобы пользователи ничего не заметили.

## 2. Новая структура фронтенда

Дерево каталога `frontend/` выглядит так:

```
frontend/
├── index.html                  # корневая HTML-страница, сюда React монтирует приложение
├── package.json                # зависимости и npm-скрипты
├── tsconfig*.json              # настройки TypeScript
├── vite.config.ts              # конфигурация Vite (сборщик и dev-сервер)
├── public/                     # статические файлы
└── src/
    ├── App.tsx                 # вход в React-роутер
    ├── main.tsx                # точка монтирования React
    ├── styles.css              # глобальные стили
    ├── api/                    # функции для общения с backend
    │   └── auth.ts             # запросы на /auth
    ├── components/
    │   ├── AuthLayout.tsx      # базовый макет для страниц входа/регистрации
    │   └── Logo.tsx            # простая заглушка-логотип
    └── pages/
        ├── AuthForm.module.css # общие стили для форм
        ├── LoginPage.tsx       # страница авторизации
        ├── RegisterPage.module.css # дополнительные стили для регистрации
        └── RegisterPage.tsx    # страница регистрации
```

Мы используем [Vite](https://vitejs.dev/) как лёгкий инструмент сборки и разработки. Он даёт быстрый hot-reload и минимальную конфигурацию.

## 3. Маршрутизация в React

В `App.tsx` описаны маршруты, которые повторяют старое поведение:

- `/` — моментально перенаправляет на `/login`.
- `/login` — форма входа, при успехе в будущем будет перенаправлять пользователя в основной интерфейс.
- `/register` — форма регистрации.

Используется пакет `react-router-dom`, поэтому любую новую страницу будем добавлять через `<Routes>` и `<Route>`.

## 4. Работа с API

Файл `src/api/auth.ts` инкапсулирует запросы к backend. Мы используем `axios` и базовый URL из переменной окружения `VITE_API_BASE_URL`. Это позволяет:

- в разработке обращаться к `http://localhost:8000` (FastAPI);
- в продакшене подставить URL, указанный через Docker Compose.

Каждая функция выбрасывает информативные ошибки, чтобы можно было показать пользователю понятные сообщения.

## 5. Компоновка страниц

Компонент `AuthLayout` даёт общий каркас (карточка по центру экрана, логотип). Внутри него `Outlet` рендерит конкретную страницу. Таким образом, мы избегаем дублирования верстки между логином и регистрацией.

Стили написаны в формате CSS Modules, что обеспечивает scoped-область — стили не конфликтуют между компонентами. Общие правила лежат в `AuthForm.module.css`, а в `RegisterPage.module.css` добавлены только специфичные подсказки об успешной регистрации.

## 6. Дальнейшие шаги

1. Добавить управление токеном: сохранять его в `localStorage` или cookie и перенаправлять пользователя после логина.
2. Реализовать защиту маршрутов (редиректить неавторизованных пользователей на `/login`).
3. Постепенно переносить остальные шаблоны (склады, админка) в отдельные React-страницы.
4. Настроить дизайн-систему (например, Tailwind или собственный набор компонентов), когда появятся более сложные экраны.

## 7. Зачем всё это документировано

Все шаги описаны подробно, чтобы можно было:

- повторить процесс на других проектах;
- быстро понять, какие файлы за что отвечают;
- объяснить коллегам или себе в будущем, как устроен фронтенд.

При добавлении новых страниц просто расширяйте раздел "Маршрутизация" и дополняйте список компонентов.
